<!DOCTYPE html>
<html lang="id">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Toko Tanaman Obat</title>

    <!-- Bootstrap 5 CDN -->
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css"
      rel="stylesheet"
    />

    <!-- Custom CSS -->
    <link rel="stylesheet" href="css/style.css" />
  </head>
  <body>
    <!-- Navbar -->
    <nav class="navbar navbar-expand-lg navbar-dark bg-success sticky-top">
      <div class="container">
        <a class="navbar-brand fw-bold" href="#">ðŸŒ¿ Toko Tanaman Obat</a>
        <button
          class="navbar-toggler"
          type="button"
          data-bs-toggle="collapse"
          data-bs-target="#navbarNav"
        >
          <span class="navbar-toggler-icon"></span>
        </button>
        <div class="collapse navbar-collapse" id="navbarNav">
          <ul class="navbar-nav ms-auto">
            <li class="nav-item">
              <a class="nav-link active" href="index.html">Beranda</a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="cart.html">Keranjang ðŸ›’</a>
            </li>
          </ul>
        </div>
      </div>
    </nav>

    <!-- Hero Section -->
    <section class="py-5 text-center bg-light">
      <div class="container">
        <h1 class="fw-bold text-success">
          Selamat Datang di Toko Tanaman Obat
        </h1>
        <p class="lead">
          Temukan berbagai tanaman obat alami untuk kesehatan dan kebugaran Anda
          ðŸŒ±
        </p>
      </div>
    </section>

    <!-- Product Grid -->
    <div class="container my-5">
      <div class="row" id="product-list">
        <!-- Produk akan dimuat melalui JavaScript -->
      </div>
      <div id="pagination" class="my-4"></div>
    </div>

    <!-- Footer -->
    <footer class="text-center bg-success text-white py-3 mt-5">
      <p class="mb-0">&copy; 2025 Toko Tanaman Obat - Semua Hak Dilindungi</p>
    </footer>

    <!-- Bootstrap JS Bundle -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>

    <!-- === Script JS Utama === -->
    <script>
      const produkContainer = document.getElementById("product-list");
      const paginationContainer = document.getElementById("pagination");
      let cart = JSON.parse(localStorage.getItem("cart")) || [];

      // Pagination setup
      let currentPage = 1;
      const itemsPerPage = 6;
      let allProducts = [];

      // Render produk per halaman
      function renderProducts() {
        const start = (currentPage - 1) * itemsPerPage;
        const end = start + itemsPerPage;
        const productsToShow = allProducts.slice(start, end);

        produkContainer.innerHTML = productsToShow
          .map(
            (p) => `
        <div class="col-md-4 mb-4">
          <div class="card h-100 shadow-sm">
            <img src="${p.gambar}" class="card-img-top" alt="${
              p.nama
            }" loading="lazy" />
            <div class="card-body text-center">
              <h5 class="card-title text-success fw-bold">${p.nama}</h5>
              <p class="card-text text-muted">${p.deskripsi}</p>
              <p class="fw-semibold mb-2">Rp ${p.harga.toLocaleString(
                "id-ID"
              )}</p>
              <button class="btn btn-success w-100" onclick="addToCart(${
                p.id
              }, '${p.nama}', ${p.harga}, '${p.gambar}')">
                ðŸ›’ Tambah ke Keranjang
              </button>
            </div>
          </div>
        </div>
      `
          )
          .join("");

        renderPagination();
      }

      // Render tombol pagination
      function renderPagination() {
        const totalPages = Math.ceil(allProducts.length / itemsPerPage);

        paginationContainer.innerHTML = `
      <nav>
        <ul class="pagination justify-content-center">
          <li class="page-item ${currentPage === 1 ? "disabled" : ""}">
            <button class="page-link" onclick="changePage(${
              currentPage - 1
            })">Sebelumnya</button>
          </li>
          ${Array.from(
            { length: totalPages },
            (_, i) => `
            <li class="page-item ${currentPage === i + 1 ? "active" : ""}">
              <button class="page-link" onclick="changePage(${i + 1})">${
              i + 1
            }</button>
            </li>
          `
          ).join("")}
          <li class="page-item ${currentPage === totalPages ? "disabled" : ""}">
            <button class="page-link" onclick="changePage(${
              currentPage + 1
            })">Berikutnya</button>
          </li>
        </ul>
      </nav>
    `;
      }

      // Ganti halaman
      function changePage(page) {
        const totalPages = Math.ceil(allProducts.length / itemsPerPage);
        if (page < 1 || page > totalPages) return;
        currentPage = page;
        renderProducts();
      }

      // Load semua produk
      async function loadProducts() {
        try {
          const res = await fetch("data/products.json");
          allProducts = await res.json();
          renderProducts();
        } catch (error) {
          produkContainer.innerHTML =
            "<p class='text-danger text-center'>Gagal memuat produk.</p>";
        }
      }

      // Tambah ke keranjang
      function addToCart(id, nama, harga, gambar) {
        const existingItem = cart.find((item) => item.id === id);

        if (existingItem) {
          existingItem.jumlah += 1;
        } else {
          cart.push({ id, nama, harga, gambar, jumlah: 1 });
        }

        localStorage.setItem("cart", JSON.stringify(cart));
        alert(`${nama} telah ditambahkan ke keranjang!`);
      }

      document.addEventListener("DOMContentLoaded", loadProducts);
    </script>
  </body>
</html>
